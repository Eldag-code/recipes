library(dplyr)
src <- src_sqlite("recipes.sqlite3")
src
recipes <- tbl(src, "recipes")
recipes
recipes <- collect(tbl(src, "recipes"))
library(yaml)
categories <- collect(tbl(src, "categories"))
src
categoires
categories
head(recipes)
categories <- collect(tbl(src, "categories")) %>% select(category_id = id, name)
head(categories)
categories <- src %>%
tbl("categories") %>%
select(category_id = id, name) %>%
collect()
categories <- src %>%
tbl("categories") %>%
select(category_id = id, name)
recipes <- src %>%
tbl("recipes") %>%
left_join(categories)
recipes
categories
recipes <- src %>%
tbl("recipes") %>%
left_join(categories, "category_id")
head(recipes)
categories <- src %>%
tbl("categories") %>%
select(category_id = id, category = name)
recipes <- src %>%
tbl("recipes") %>%
left_join(categories)
recipes
recipes <- src %>%
tbl("recipes") %>%
left_join(categories) %>%
select(-category_id)
recipes
recipes <- src %>%
tbl("recipes") %>%
left_join(categories) %>%
select(-category_id) %>%
collect()
head(recipes)
glimpse(recipes)
slug <- function(x) {
x <- tolower(x)
x <- gsub("[^a-z]*", "-")
x <- gsub("-+", "-", x)
x <- gsub("^-|i$", "", x)
x
}
recipes$slug <- slug(recipes$name)
slug <- function(x) {
x <- tolower(x)
x <- gsub("[^a-z]*", "-", x)
x <- gsub("-+", "-", x)
x <- gsub("^-|i$", "", x)
x
}
recipes$slug <- slug(recipes$name)
recipes$slug
slug <- function(x) {
x <- tolower(x)
x <- gsub("[^a-z]+", "-", x)
x <- gsub("-+", "-", x)
x <- gsub("^-|i$", "", x)
x
}
recipes$slug <- slug(recipes$name)
recipes$slug
slug <- function(x) {
x <- tolower(x)
x <- gsub("[^a-z]+", "-", x)
x <- gsub("-+", "-", x)
x <- gsub("^-|-$", "", x)
x
}
recipes$slug <- slug(recipes$name)
recipes$slug
?make.unique
slug <- function(x) {
x <- tolower(x)
x <- gsub("[^a-z]+", "-", x)
x <- gsub("-+", "-", x)
x <- gsub("^-|-$", "", x)
x <- make.unique(x, "-")
}
recipes$slug <- slug(recipes$name)
recipes$slug
slug <- function(x) {
x <- tolower(x)
x <- gsub("'", "", x)
x <- gsub("[^a-z]+", "-", x)
x <- gsub("-+", "-", x)
x <- gsub("^-|-$", "", x)
x <- make.unique(x, "-")
}
recipes$slug <- slug(recipes$name)
recipes$slug
unique(recipes$category)
dput(unique(recipes$category))
categories <- data.frame(cat = unique(recipes$category))
categories$path <- ""
categories %>% edit()
write.csv("categories.csv", categories, row.names = FALSE)
write.csv(categories, "categories.csv", row.names = FALSE)
saveRDS(recipes, "recipes.rds")
recipes <- readRDS("recipes.rds")
library(dplyr)
names(recipes)
dir.create(categories$paths)
categories <- read.csv("categories.csv", stringsAsFactors = FALSE)
dir.create(categories$paths)
categories$paths
categories$path
dir.create(categories$path)
lapply(categories$path, dir.create)
invisible(lapply(categories$path, dir.create))
recipes <- readRDS("recipes.rds") %>% left_join(categories)
head(recipes)
recipes
recipes$viewed
recipes$created_on
recipes$update_on
recipes$updated_on
recipes$source
recipes$quantity
recipes$cookTime
recipes$preparationTime
recipes
recipes$comment
names(recipes)
recipe <- recipes[1, ]
recipe
meta <- unlist(recipe[c("source", "cookTime", "preparationTime", "updated_on", "comment")])
meta <- unlist(recipe[c("source", "cookTime", "preparationTime", "updated_on", "comments")])
meta
meta <- meta[!is.na(meta) && meta != ""]
meta
meta <- unlist(recipe[c("source", "cookTime", "preparationTime", "comments")])
meta <- meta[!is.na(meta) && meta != ""]
meta
as.yaml(meta)
library(yaml)
as.yaml(as.list(meta))
as.yaml(list(a = x))
as.yaml(list(a = "x"))
as.list(meta)
all <- paste0(
"---\n",
meta_yaml,
"---\n\n",
recipe$ingredients,
"---\n\n",
recipe$method,
"\n"
)
if (length(meta) > 0) {
meta_yaml <- as.yaml(as.list(meta))
} else {
meta_yaml <- "\n"
}
all <- paste0(
"---\n",
meta_yaml,
"---\n\n",
recipe$ingredients,
"---\n\n",
recipe$method,
"\n"
)
cat(al)
cat(all)
recipe$updated_on
recipes$updated_on
strptime(recipes$updated_on)
strptime(recipes$updated_on, "%Y-%m-%d")
strptime(recipes$updated_on, "%Y-%m-%d, %H:%M:%S")
strptime(recipes$updated_on, "%Y-%m-%d, %H:%M:%s")
strptime(recipes$updated_on, "%Y-%m-%d, %H:%M")
strptime(recipes$updated_on, "%Y-%m-%d, %H:%n")
strptime(recipes$updated_on, "%Y-%m-%d, %H:%m")
strptime(recipes$updated_on, "%Y-%m-%d, %H:%M")
strptime(recipes$updated_on, "%Y-%m-%d, %h:%M")
strptime(recipes$updated_on, "%Y-%m-%d %h:%M")
strptime(recipes$updated_on, "%Y-%m-%d %H:%M")
strptime(recipes$updated_on, "%Y-%m-%d %H:%M:%S")
head(strptime(recipes$updated_on, "%Y-%m-%d %H:%M:%S"))
head(recipes$updated_on)
recipes <- readRDS("recipes.rds") %>%
left_join(categories) %>%
mutate(updated_on = strptime(updated_on, "%Y-%m-%d %H:%M:%S"))
recipes <- readRDS("recipes.rds") %>%
left_join(categories) %>%
mutate(updated_on = as.POSIXct(strptime(updated_on, "%Y-%m-%d %H:%M:%S")))
recipe <- recipes[1, ]
recipe$updated_on
format(recipe$updated_on, "%y%m%d%H%M%S")
format(recipe$updated_on, "%Y%m%d%H%M%S")
format(recipe$updated_on, "%Y%m%d%H%M.%S")
source('~/.active-rstudio-document')
source('~/Desktop/recipes/1-export.R')
save_recipes(recipes[1, ])
save_recipe(recipes[1, ])
out
path <- paste0(recipe$path, "/", recipe$slug, ".md")
path
writeLines(out, path)
system(paste("touch -t ", format(recipe$updated_on, "%Y%m%d%H%M.%S"), " ", path))
source('~/Desktop/recipes/1-export.R')
for(i in seq_along(nrow(recipes))) save_recipe(recipes[i, ])
seq_along(nrow(recipes)
for(i in seq_len(nrow(recipes))) save_recipe(recipes[i, ])
source('~/.active-rstudio-document')
source('~/Desktop/recipes/1-export.R')
filter(categories, is.na(path))
filter(recipes, is.na(path))
readRDS("recipes.rds")
head(readRDS("recipes.rds"))
categories
source('~/Desktop/recipes/1-export.R')
paths <- file.path("recipes", categories$path)
paths[!file.exists(paths)]
dir.create(paths[!file.exists(paths)])
invisible(lapply(paths[!file.exists(paths)], dir.create))
source('~/.active-rstudio-document')
source('~/Desktop/recipes/1-export.R')
source('~/.active-rstudio-document')
trim("abc\n\n")
trim("abc\n\r")
source('~/.active-rstudio-document')
afghans <- filter(recipes, name = "Afghans")
afghans <- filter(recipes, name =- "Afghans")
afghans <- filter(recipes, name == "Afghans")
afghans
afghans@method
afghans$method
trim(afghans$method)
trim(afghans$ingredients)
source('~/Desktop/recipes/1-export.R')
trim(afghans$method)
source('~/Desktop/recipes/1-export.R')
source('~/.active-rstudio-document')
save_recipe(afghans)
meta
meta[!is.na(meta) && meta != ""]
is.na(meta)
source('~/Desktop/recipes/1-export.R')
source('~/.active-rstudio-document')
source('~/Desktop/recipes/1-export.R')
